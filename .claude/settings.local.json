{
  "permissions": {
    "allow": [
      "mcp__ace-tool__enhance_prompt",
      "Bash(curl:*)",
      "mcp__ace-tool__search_context",
      "Bash(npx create-next-app@latest api-key-dashboard --typescript --tailwind --app --no-src-dir --import-alias \"@/*\" --eslint)",
      "Bash(pnpm init)",
      "Bash(pnpm add date-fns zod @radix-ui/react-dialog @radix-ui/react-label @radix-ui/react-slot)",
      "Bash(pnpm dev)",
      "Bash(pnpm build)",
      "Bash(git init:*)",
      "Bash(git add:*)",
      "Bash(git commit:*)",
      "Bash(/Users/vesper/.claude/bin/codeagent-wrapper --backend gemini - \"$PWD\" <<'EOF'\nROLE_FILE: /Users/vesper/.claude/.ccg/prompts/gemini/frontend.md\n<TASK>\n需求：全面优化 API Key Dashboard 的 UI 和功能\n\n## 核心问题\n1. **UI 问题**：\n   - 图标位置错位\n   - 布局过于松散，模块化太浓\n   - 教程页面模板化严重，需要改成专业文档风格\n   - 区块占比过大，信息密度低\n   - 缺乏专业感和吸引力\n\n2. **功能缺失**：\n   - Dashboard 主页（app/page.tsx）还是默认模板，需要实现真实的数据面板\n   - 需要对接真实的 New API 获取数据\n   - 实现真实的额度查询、可视化、数据分析\n\n## API 配置\n- API 地址：https://api-cli.proxy.vesper36.cc\n- 已配置在 .env.local 文件中\n\n## 优化要求\n\n### 1. Dashboard 主页重构（最优先）\n- 实现紧凑、信息密度高的布局\n- 真实数据展示（调用 New API）\n- 统计卡片：余额、今日花费、调用次数、缓存次数\n- 使用趋势图（Recharts）\n- 模型分布图\n- Token 消耗详情表格\n- 实时数据刷新\n\n### 2. 教程页面重构\n- 改成现代化专业文档风格（类似 Vercel、Next.js 文档）\n- 紧凑布局，信息集中\n- 侧边栏导航\n- 代码示例高亮\n- 搜索功能（可选）\n\n### 3. 整体 UI 优化\n- 修复所有图标错位问题\n- 减少空白，提高信息密度\n- 统一间距和字体大小\n- 优化响应式布局\n- 提升视觉层次感\n\n### 4. 真实数据对接\n- 完善 NewAPIClient 的实现\n- 在 Dashboard 中调用真实 API\n- 实现数据加载状态\n- 错误处理和重试机制\n- 缓存策略\n\n## 技术栈\n- Next.js 16 + React 19 + TypeScript\n- Tailwind CSS 4\n- shadcn/ui\n- Recharts\n- Zustand\n\n## 现有文件\n- lib/api/newapi.ts - API 客户端（已有基础实现）\n- lib/store/useStore.ts - 状态管理\n- app/page.tsx - Dashboard 主页（需要完全重写）\n- app/tutorial/page.tsx - 教程页（需要重构）\n- components/dashboard/* - Dashboard 组件（需要优化）\n\n## 输出要求\n1. 完全重写 app/page.tsx，实现真实的 Dashboard\n2. 重构 app/tutorial/page.tsx，采用专业文档风格\n3. 优化所有 Dashboard 组件\n4. 确保所有图标正确对齐\n5. 实现真实的数据查询和展示\n6. 紧凑布局，高信息密度\n7. 专业、现代、吸引人的设计\n\n请立即开始实施，优先完成 Dashboard 主页的重构。\n</TASK>\nOUTPUT: 完整的优化后代码\nEOF)",
      "Bash(npx shadcn@latest add scroll-area separator)",
      "Bash(lsof:*)",
      "Bash(xargs kill:*)",
      "Bash(git restore:*)",
      "Bash(xargs ps:*)",
      "Bash(pkill:*)",
      "Bash(/Users/vesper/.claude/bin/codeagent-wrapper --backend gemini - \"$PWD\" <<'EOF'\nROLE_FILE: /Users/vesper/.claude/.ccg/prompts/gemini/frontend.md\n<TASK>\n需求：阶段1 - 紧急修复和 UI 优化\n\n## 核心问题修复\n\n### 1. UI 错位问题（最高优先级）\n**问题描述**：\n- 左上角 LOGO 贴边不合理，需要合适的内边距\n- 右上角元素（GitHub、主题切换、设置）不在一行，完全错位\n- 整体布局需要精细调整\n\n**修复要求**：\n- Header 组件：确保所有元素正确对齐在一行\n- Logo 添加合适的左侧内边距（如 px-6）\n- 右侧按钮组使用 flex 布局确保在同一行\n- 移动端响应式处理\n\n### 2. 真实额度显示问题\n**问题描述**：Dashboard 无法显示真实的 API 额度数据\n\n**修复要求**：\n- 检查 API 调用逻辑\n- 确保 NewAPIClient 正确获取额度\n- 添加错误处理和加载状态\n- 显示真实的余额、已用额度等数据\n\n### 3. 高级视觉效果（毛玻璃效果）\n**设计要求**：\n- 实现 glassmorphism（毛玻璃）效果\n- 半透明背景 + backdrop-blur\n- 高级、流畅、顺滑的视觉体验\n- 信息密度高但不空旷\n- 参考现代设计趋势（如 macOS Big Sur、iOS 风格）\n\n**应用位置**：\n- Header 导航栏\n- Sidebar 侧边栏\n- Card 卡片组件\n- Dialog 对话框\n- 统计卡片\n\n**实现方式**：\n```css\n/* 毛玻璃效果示例 */\n.glass {\n  background: rgba\\(255, 255, 255, 0.1\\);\n  backdrop-filter: blur\\(10px\\);\n  border: 1px solid rgba\\(255, 255, 255, 0.2\\);\n}\n\n.glass-dark {\n  background: rgba\\(0, 0, 0, 0.3\\);\n  backdrop-filter: blur\\(10px\\);\n  border: 1px solid rgba\\(255, 255, 255, 0.1\\);\n}\n```\n\n### 4. 双语支持（中文/英文）\n**要求**：\n- 默认语言：中文\n- 可切换：英语\n- 实现方案：使用 next-intl 或简单的 context\n- 语言切换器：添加到 Header 或 Settings\n\n**需要翻译的内容**：\n- 导航菜单（Dashboard、Keys、Tutorial、Settings）\n- Dashboard 页面（统计卡片标题、图表标签）\n- Keys 页面（表单标签、按钮）\n- Tutorial 页面（文档内容）\n- Settings 页面（设置项）\n\n### 5. 简化 API Key 添加流程\n**当前问题**：\n- 有 \"Platform\" 选择（New API / One API / Other）\n- 有 \"Base URL\" 输入框\n\n**修改要求**：\n- 移除 \"Platform\" 选择器\n- 移除 \"Base URL\" 输入框\n- 后端写死 API 地址：`https://api-cli.proxy.vesper36.cc`\n- 只保留两个字段：\n  1. Name（名称）\n  2. Key（API 密钥）\n\n**修改文件**：\n- `components/keys/AddKeyDialog.tsx`\n- `lib/store/useStore.ts`（更新 APIKey 类型）\n- `lib/types/index.ts`（更新类型定义）\n\n### 6. 文档页面重构\n**当前问题**：布局、构造、排版不满意\n\n**优化要求**：\n- 更紧凑的布局\n- 更好的信息层次\n- 更清晰的代码示例\n- 更好的导航体验\n- 参考 Vercel、Stripe、Supabase 的文档风格\n\n### 7. 设置页面优化\n**当前问题**：内容太少太空，占用空间过多\n\n**优化要求**：\n- 增加更多设置项\n- 紧凑的布局\n- 分组管理（外观、数据、通知等）\n- 添加语言切换选项\n\n## 技术栈\n- Next.js 16 + React 19 + TypeScript\n- Tailwind CSS 4\n- shadcn/ui\n- next-themes（主题管理）\n- Zustand（状态管理）\n\n## 项目上下文\n- API 地址：https://api-cli.proxy.vesper36.cc\n- 使用 New API 项目作为后端\n- 已有完整的布局系统（Header + Sidebar）\n- 已有主题系统（亮/暗模式）\n- 已有 API 客户端（NewAPIClient）\n\n## 输出要求\n1. 修复所有 UI 错位问题\n2. 实现毛玻璃效果\n3. 添加双语支持（中文/英文）\n4. 简化 API Key 添加流程\n5. 优化文档和设置页面\n6. 确保真实额度数据正确显示\n7. 保持响应式设计\n8. 保持代码质量和类型安全\n\n请提供完整的代码修改方案（Unified Diff Patch 格式）。\n</TASK>\nOUTPUT: 完整的优化后代码（Unified Diff Patch）\nEOF)"
    ]
  }
}
